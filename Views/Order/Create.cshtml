@model Restaurant_Manager.Models.CustomerOrder

@{
	ViewData["Title"] = "Create";
	Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Create</h1>

<h4>CustomerOrder</h4>
<hr />
<div class="row">
	<div class="col-md-4">
		<form asp-action="Create">
			<div asp-validation-summary="ModelOnly" class="text-danger"></div>
			@* <div class="form-group">
			<label asp-for="Date" class="control-label"></label>
			<input asp-for="Date" class="form-control" />
			<span asp-validation-for="Date" class="text-danger"></span>
			</div> *@
			@* <div class="form-group form-check">
			<label class="form-check-label">
			<input class="form-check-input" asp-for="Open" /> @Html.DisplayNameFor(model => model.Open)
			</label>
			</div> *@
			<div id="productList">
				<div class="form-group">
					<label for="products" class="control-label">Product</label>
					<select class="form-control" name="products" asp-items="ViewBag.Products"></select>
				</div>
				<div class="form-group">
					<label for="quantity" class="form-label">Quantity</label>
					<input type="number" required class="form-control" id="quantity" name="quantity" min="1" step="1" placeholder="quantity">
				</div>
			</div>
			<div class="form-group">
				<input type="submit" value="Create" class="btn btn-primary" />
				<button type="button" class="btn btn-primary" onclick="addProduct()">Add Another Product</button>
			</div>

		</form>
	</div>
</div>

<div>
	<a asp-action="Index">Back to List</a>
</div>

<script>
	let productCount = 1;

	let selectElement = document.querySelector('[name=products]');
	let optionNames = [...selectElement.options].map(o => o.text)
	let optionValues = [...selectElement.options].map(o => o.value)

	function addProduct() {
		const productList = document.getElementById('productList');
		const newProduct = document.createElement('div');
		newProduct.innerHTML = `
						<div class="form-group">
							<label for="products" class="control-label"></label>
								<select class="form-control" name="products" id="generatedSelect${productCount}"></select>
						</div>
						<div class="form-group">
							<label for="quantity" class="form-label">Quantity</label>
							<input type="number" required class="form-control" id="quantity" name="quantity" min="0" step="1" placeholder="quantity">
						</div>
							  `;
		productList.appendChild(newProduct);
		let selected = document.getElementById('generatedSelect' + productCount);

		for (let i = 0; i < optionValues.length; i++) {
			selected.options[selected.options.length] = new Option(optionNames[i], optionValues[i]);
		}
		productCount++;
	}
</script>

@section Scripts {
	@{
		await Html.RenderPartialAsync("_ValidationScriptsPartial");
	}
}
